Version 4
SHEET 1 3728 2744
WIRE 1104 1328 1104 1296
WIRE 1296 1328 1296 1296
WIRE 672 1376 672 1344
WIRE 816 1376 816 1344
WIRE 1104 1408 1104 1392
WIRE 1104 1408 1072 1408
WIRE 1296 1408 1296 1392
WIRE 1296 1408 1264 1408
WIRE 1104 1424 1104 1408
WIRE 1296 1424 1296 1408
WIRE 672 1504 672 1456
WIRE 816 1504 816 1456
WIRE 1104 1520 1104 1488
WIRE 1296 1520 1296 1488
WIRE 2816 1664 2592 1664
WIRE 2816 1680 2816 1664
WIRE 2496 1760 2480 1760
WIRE 2592 1760 2592 1664
WIRE 2592 1760 2576 1760
WIRE 2608 1760 2592 1760
WIRE 2816 1760 2816 1744
WIRE 2816 1760 2768 1760
WIRE 2416 1856 2400 1856
WIRE 2496 1856 2480 1856
WIRE 2208 1888 2016 1888
WIRE 3104 1920 3104 1904
WIRE 1632 1952 1632 1936
WIRE 2400 1952 2400 1856
WIRE 2496 1952 2496 1856
WIRE 2496 1952 2480 1952
WIRE 2720 1984 2720 1952
WIRE 2112 2000 2112 1968
WIRE 2592 2000 2592 1760
WIRE 2688 2000 2592 2000
WIRE 2016 2016 2016 1888
WIRE 2080 2016 2016 2016
WIRE 2816 2016 2816 1760
WIRE 2816 2016 2752 2016
WIRE 2832 2016 2816 2016
WIRE 2912 2016 2896 2016
WIRE 3056 2016 2912 2016
WIRE 3104 2016 3104 1984
WIRE 3104 2016 3056 2016
WIRE 3200 2016 3104 2016
WIRE 3312 2016 3280 2016
WIRE 2208 2032 2208 1888
WIRE 2208 2032 2144 2032
WIRE 2400 2032 2400 1952
WIRE 2400 2032 2208 2032
WIRE 2496 2032 2496 1952
WIRE 2496 2032 2480 2032
WIRE 2688 2032 2496 2032
WIRE 2912 2032 2912 2016
WIRE 3520 2032 3520 2016
WIRE 1312 2048 1216 2048
WIRE 1376 2048 1312 2048
WIRE 1536 2048 1456 2048
WIRE 1632 2048 1632 2016
WIRE 1632 2048 1536 2048
WIRE 1824 2048 1632 2048
WIRE 1936 2048 1824 2048
WIRE 2080 2048 2016 2048
WIRE 3104 2048 3104 2016
WIRE 1824 2064 1824 2048
WIRE 816 2080 816 2064
WIRE 1632 2080 1632 2048
WIRE 2720 2080 2720 2048
WIRE 2112 2096 2112 2064
WIRE 2496 2128 2496 2112
WIRE 2912 2128 2912 2112
WIRE 3104 2128 3104 2112
WIRE 3520 2128 3520 2112
WIRE 1632 2160 1632 2144
WIRE 816 2176 816 2160
WIRE 1312 2192 1312 2048
WIRE 1536 2192 1536 2048
WIRE 624 2336 624 2304
WIRE 816 2336 816 2304
WIRE 1312 2352 1312 2256
WIRE 1536 2352 1536 2256
WIRE 1824 2352 1824 2144
WIRE 624 2432 624 2416
WIRE 816 2432 816 2416
FLAG 2112 1968 vcc
IOPIN 2112 1968 In
FLAG 2112 2096 vee
IOPIN 2112 2096 In
FLAG 2480 1760 0
FLAG 2720 1952 vcc
IOPIN 2720 1952 In
FLAG 2720 2080 vee
IOPIN 2720 2080 In
FLAG 672 1344 vcc
IOPIN 672 1344 In
FLAG 816 1344 vee
IOPIN 816 1344 In
FLAG 816 2432 0
FLAG 3312 2016 out_meas
IOPIN 3312 2016 Out
FLAG 2912 2128 0
FLAG 672 1504 0
FLAG 816 1504 0
FLAG 1824 2352 0
FLAG 816 2176 0
FLAG 816 2064 Vtrig
IOPIN 816 2064 Out
FLAG 624 2432 0
FLAG 1216 2048 vin
IOPIN 1216 2048 In
FLAG 2496 2128 0
FLAG 3104 1904 vcc
IOPIN 3104 1904 In
FLAG 3104 2128 vee
IOPIN 3104 2128 In
FLAG 3520 2016 out_meas
IOPIN 3520 2016 In
FLAG 3520 2128 0
FLAG 624 2304 vin
IOPIN 624 2304 In
FLAG 1312 2352 0
FLAG 1536 2352 0
FLAG 1632 1936 vcc
IOPIN 1632 1936 In
FLAG 1632 2160 vee
IOPIN 1632 2160 In
FLAG 1104 1296 vcc
IOPIN 1104 1296 In
FLAG 1104 1520 vee
IOPIN 1104 1520 In
FLAG 1072 1408 0
FLAG 1296 1296 vcc
IOPIN 1296 1296 In
FLAG 1296 1520 vee
IOPIN 1296 1520 In
FLAG 1264 1408 0
FLAG 3056 2016 output
SYMBOL res 2496 2016 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 27k
SYMBOL res 2592 1744 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 47k
SYMBOL res 2784 1744 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rgain
SYMATTR Value {rgain}
SYMBOL voltage 816 2320 R0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
WINDOW 3 24 96 Invisible 2
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=1
SYMATTR Value SINE(0 {vinsin} 1meg 0u {1/100e-6} 0)
SYMATTR InstName V2
SYMBOL cap 2896 2000 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 220µ
SYMBOL res 2896 2016 R0
SYMATTR InstName R5
SYMATTR Value 1Meg
SYMBOL voltage 672 1360 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=10m
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 816 1472 M180
WINDOW 123 0 0 Left 2
WINDOW 39 24 68 Left 2
SYMATTR SpiceLine Rser=10m
SYMATTR InstName V3
SYMATTR Value 12
SYMBOL res 3296 2000 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rprotout
SYMATTR Value {rprotout}
SYMBOL res 1808 2048 R0
SYMATTR InstName Rref
SYMATTR Value 1Meg
SYMBOL voltage 816 2064 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value SINE(0 2 50)
SYMBOL res 2032 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rprotin
SYMATTR Value 100
SYMBOL voltage 624 2320 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V5
SYMATTR Value SINE(0 11 60)
SYMBOL res 2480 2016 R0
SYMATTR InstName R3
SYMATTR Value 15k
SYMBOL schottky 3088 1984 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 3088 2112 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 3504 2016 R0
SYMATTR InstName Rload
SYMATTR Value 1Meg
SYMBOL Opamps\\LT1638 2112 1968 R0
SYMATTR InstName U1
SYMBOL Opamps\\LT1638 2720 1952 R0
SYMATTR InstName U1b
SYMBOL res 1472 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rprot
SYMATTR Value 20k
SYMBOL res 2496 1936 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 27k
SYMBOL cap 2800 1680 R0
SYMATTR InstName C1
SYMATTR Value 22p
SYMBOL cap 2480 1840 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 100p
SYMBOL cap 1296 2192 R0
SYMATTR InstName Cx
SYMATTR Value 0µ18
SYMBOL cap 1520 2192 R0
SYMATTR InstName Cprot
SYMATTR Value {cprot}
SYMBOL schottky 1616 2016 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1616 2144 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 1088 1328 R0
SYMATTR InstName Cps1
SYMATTR Value 100n
SYMBOL cap 1088 1424 R0
SYMATTR InstName Cps2
SYMATTR Value 100n
SYMBOL cap 1280 1328 R0
SYMATTR InstName Cps3
SYMATTR Value 100n
SYMBOL cap 1280 1424 R0
SYMATTR InstName Cps4
SYMATTR Value 100n
SYMBOL res 2704 1744 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 22k5
TEXT 2368 1408 Left 2 ;.tran 0 {5/60} 0 100u
TEXT 2368 1440 Left 2 !.ac oct 10 20 6k
TEXT 736 1968 Left 2 !.param vinsin=4k
TEXT 1320 2280 Left 2 ;0.18UF,50V,5%
TEXT 1344 1936 Left 2 ;Several high-power \nMELF resistors.
TEXT 2016 1536 Center 4 ;Input buffer
TEXT 2656 1536 Center 4 ;Gain stage
TEXT 736 1856 Center 4 ;Input signal\ngenerators
TEXT 752 1184 Center 4 ;Ideal power\nsupply +/-12V
TEXT 1544 2280 Left 2 ;Not\npopulated
TEXT 1760 1232 Left 2 !.param cprot 1p
TEXT 1760 1184 Left 2 ;Input low-pass
TEXT 1760 1264 Left 2 ;.param cprot 68p will give around 100kHz
TEXT 2336 1184 Left 2 ;Gain
TEXT 2336 1232 Left 2 !.param rgain=25k2
TEXT 2336 1264 Left 2 ;.param rpot 30m for 0.5 gain
TEXT 2336 1296 Left 2 ;.param rpot 47k for 1.0 gain
TEXT 2336 1328 Left 2 ;.param rpot 100k for 1.51 gain
TEXT 1216 1192 Center 4 ;Power supply bypass
TEXT 1008 1608 Left 2 ;Put these capacitors as close as \npossible to U1 and U2
TEXT 3200 1888 Left 2 ;High-power \nMELF resistor.
TEXT 3488 2176 Left 2 ;External\nload
TEXT 624 2528 Center 2 ;SINUS
TEXT 816 2528 Center 2 ;4kV BURST
TEXT 3040 1184 Left 2 ;Temperature
TEXT 3040 1232 Left 2 !.param t0 25
TEXT 3040 1264 Left 2 !.param a1 100/1e6
TEXT 3040 1328 Left 2 !.param tt temp - t0
TEXT 3040 1360 Left 2 !.param coef1 1 + (a1 * tt)
TEXT 3040 1392 Left 2 ;.step temp -50 70 20
TEXT 3344 1232 Left 2 ;Nominal resistor temperature
TEXT 3344 1264 Left 2 ;Resistor ppm 1 parameter
TEXT 3344 1328 Left 2 ;Temperature delta
TEXT 3344 1360 Left 2 ;Resistor temp. coefficient
TEXT 3344 1392 Left 2 ;Temperature step change.\nTurn this off when simulating\nother parameters.
TEXT 2848 1888 Left 2 ;Electrolytic\n16V\n105C
TEXT 3040 1296 Left 2 !.param a2 50/1e6
TEXT 3344 1296 Left 2 ;Resistor ppm 2 parameter
TEXT 2664 1696 Left 2 ;DIP switch
TEXT 1576 1408 Left 2 ;.step param rgain list 25k5 13k 6k34 3k16 1k6 820 374 200 100 47
TEXT 3144 1808 Left 2 ;.step param rprotout list 1k 2k 5k
TEXT 3144 1760 Left 2 !.param rprotout 5k
LINE Normal 2432 2160 2432 2160 2
LINE Normal 2432 2160 2432 2160 2
LINE Normal 1728 2528 1728 1504 2
LINE Normal 2304 2528 2304 1504 2
LINE Normal 3008 2528 3008 1504 2
RECTANGLE Normal 976 2576 528 1824 2
RECTANGLE Normal 976 1152 528 1664 2
RECTANGLE Normal 2288 1360 1744 1152 2
RECTANGLE Normal 2992 1360 2320 1152 2
RECTANGLE Normal 1440 1152 992 1664 2
RECTANGLE Normal 3712 1552 3024 1152 2
